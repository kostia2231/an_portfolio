---
import "../styles/global.css";
type Image = {
    url: string;
    transformed_url: string;
};
const res = await fetch(
    "https://subtle-palmier-ae368e.netlify.app/api/data.json",
);
const res_obj = await res.json();
const imgs: Image[] = res_obj.resources;
const img_urls = imgs.map((img) => img.transformed_url);
---

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anastasia</title>
    {img_urls.map((url) => <link rel="preload" as="image" href={url} />)}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet"
    />
</head>
<div class="text-[12px] bg-white">
    <div
        class="fixed px-4 mt-[50vh] max-[500px]:px-4 w-screen text-white max-[500px]:mt-[49vh] mix-blend-difference z-30 max-w-[1440px]"
    >
        <div class="flex justify-between">
            <div class="handle_from_left">
                <p>Anastasia Potapova</p>
            </div>
            <div class="flex gap-4 handle_from_right">
                <a href="https://www.instagram.com/ana.sta.sea/">
                    <p class="cursor-pointer hover:opacity-50">Instagram</p>
                </a>
                <a href="mailto:potapova.nana@gmail.com">
                    <p class="cursor-pointer hover:opacity-50">E-mail</p>
                </a>
            </div>
        </div>
    </div>
    <div id="loader" class="flex">
        <p class="m-auto mt-[50vh] max-[500px]:mt-[49vh]">
            <span id="progress">0</span>%
        </p>
    </div>
    <div
        class="flex flex-col items-center justify-center max-[500px]:w-[100vw] max-[500px]:p-1 max-[500px]:mx-0 w-full transition-all"
        id="img_scroll_area"
    >
        <div
            id="img_wrapper"
            class="flex flex-nowrap flex-col justify-center gap-1 items-center overflow-hidden my-4 max-[500px]:my-0 max-[500px]:grid-cols-1 w-fit"
        >
            {
                img_urls.map((url, index) => (
                    <div class="relative w-fit" id="img_group">
                        <div
                            data-index={index}
                            id="bg_blured"
                            class="absolute w-full h-full inset-0 transition-all backdrop-blur-sm duration-700 ease-in-out rounded-xs"
                        />
                        <img
                            id="img_static"
                            src={url}
                            alt="img"
                            class="max-[500px]:h-auto max-[500px]:w-full object-cover rounded-xs h-[75vh]"
                        />
                    </div>
                ))
            }
        </div>
    </div>
</div>

<!-- <script>
    // Add JavaScript to ensure blur effect works consistently
    document.addEventListener("DOMContentLoaded", () => {
        const bgBlurs = document.querySelectorAll("#bg_blured");

        // Make sure all blur divs have proper height
        bgBlurs.forEach((blur) => {
            const parentHeight =
                blur.parentElement.querySelector("#img_static").offsetHeight;
            blur.style.height = `${parentHeight}px`;
        });

        // Fix for Chrome mobile - force repaint
        setTimeout(() => {
            bgBlurs.forEach((blur) => {
                blur.style.opacity = "0.99";
                setTimeout(() => {
                    blur.style.opacity = "1";
                }, 10);
            });
        }, 100);
    });
</script> -->
